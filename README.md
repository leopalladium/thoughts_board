# Thought Board

Thought Board is a full-stack web application that allows users to post short text-based "thoughts" to a public board. It is built with a modern, containerized architecture featuring a Vue.js frontend, a FastAPI backend, and a PostgreSQL database, all orchestrated with Docker Compose.

## Features

* **Create Thoughts:** Easily post new thoughts to the board.
* **View Thoughts:** See a live-updating list of all thoughts, sorted by creation time.
* **Responsive Design:** A clean and simple interface that works on all screen sizes.
* **Automated Deployment:** Continuous integration and deployment pipeline using GitHub Actions.

## Tech Stack & Architecture

The application is composed of several containerized services:

* **Frontend:**
    * **Framework:** [Vue.js 3](https://vuejs.org/)
    * **Build Tool:** [Vite](https://vitejs.dev/)
    * **Styling:** [Tailwind CSS](https://tailwindcss.com/) & [Pico.css](https://picocss.com/)
    * **HTTP Client:** [Axios](https://axios-http.com/) for communicating with the backend API.

* **Backend:**
    * **Framework:** [FastAPI](https://fastapi.tiangolo.com/)
    * **Database ORM:** [SQLModel](https://sqlmodel.tiangolo.com/) for data modeling and validation.
    * **Database:** [PostgreSQL](https://www.postgresql.org/)
    * **Database Driver:** [psycopg2](https://www.psycopg.org/docs/)

* **Infrastructure:**
    * **Containerization:** [Docker](https://www.docker.com/) & [Docker Compose](https://docs.docker.com/compose/)
    * **Reverse Proxy:** [Traefik](https://traefik.io/traefik/) for routing traffic and automated SSL certificate generation with Let's Encrypt.
    * **CI/CD:** [GitHub Actions](https://github.com/features/actions) for building and deploying Docker images to a remote server.

## Getting Started

To run this project locally, you will need [Docker](https://docs.docker.com/get-docker/) and [Docker Compose](https://docs.docker.com/compose/install/) installed.

#### 1. Clone the Repository

```bash
git clone <your-repository-url>
cd <repository-directory>
```

#### 2. Create the Environment File

The project uses environment variables for configuration. You can generate the required `.env` file using the provided script.

```bash
bash ./generate_db_password.sh
```

This will create a `.env` file in the root directory with a randomly generated database password and other default settings. You should review and update the variables as needed, especially `DOMAIN` and `EMAIL` for production use.

#### 3. Run the Application

Use Docker Compose to build and start all the services in detached mode.

```bash
docker-compose up -d --build
```

#### 4. Access the Services

* **Frontend:** `http://localhost` (or your custom domain)
* **Backend API:** `http://localhost:8000/docs`
* **Traefik Dashboard:** `http://localhost:8080`

## Environment Variables

The following environment variables are used for configuration in the `.env` file:

| Variable        | Description                                                                 | Example                 |
| --------------- | --------------------------------------------------------------------------- | ----------------------- |
| `DOMAIN`        | The primary domain for the frontend. The API will be on `api.${DOMAIN}`.       | `localhost` or `example.com` |
| `EMAIL`         | The email address for Let's Encrypt SSL certificate registration.             | `your-email@example.com`  |
| `POSTGRES_DB`   | The name of the PostgreSQL database.                                        | `thoughts_db`           |
| `POSTGRES_USER` | The username for the PostgreSQL database.                                   | `leopalladium`          |
| `DB_PASSWORD`   | The password for the PostgreSQL user. Generated by the script if not set. | `a-secure-password`     |
| `DB_ECHO_SQL`   | Set to `true` to log SQL queries from the backend.                          | `false`                 |

## API Endpoints

The backend provides the following API endpoints, which you can interact with at `/docs` on the backend service URL.

* `GET /`
    * **Description:** Returns a welcome message.
* `POST /thoughts/`
    * **Description:** Creates a new thought.
    * **Request Body:** `{"content": "string"}`
* `GET /thoughts/`
    * **Description:** Retrieves a list of all thoughts, sorted by creation date.

## Deployment

Deployment is automated via a GitHub Actions workflow defined in `.github/workflows/docker-publish.yml`.

The workflow is triggered on every `push` to the `master` branch and consists of two main jobs:

1.  **Build:**
    * Builds the frontend and backend Docker images.
    * Pushes the images to the GitHub Container Registry (GHCR).
    * Signs the images using Cosign for security.

2.  **Deploy:**
    * Connects to the production server via SSH.
    * Logs into GHCR.
    * Pulls the new Docker images.
    * Restarts the `frontend` and `backend` services using `docker-compose`.
    * Prunes old images to save disk space.

For this to work, you must configure the following secrets in your GitHub repository settings: `SSH_HOST`, `SSH_USER`, `SSH_PRIVATE_KEY`, and `GHCR_PAT`.

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.